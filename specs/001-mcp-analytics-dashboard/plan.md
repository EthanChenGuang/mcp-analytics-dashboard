# Implementation Plan: MCP Analytics Dashboard

**Branch**: `001-mcp-analytics-dashboard` | **Date**: 2025-01-27 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-mcp-analytics-dashboard/spec.md`

**Note**: This template is filled in by the `/speckit.plan` command. See `.specify/templates/commands/plan.md` for the execution workflow.

## Summary

Build a single-page analytics dashboard for MCP (Model Context Protocol) server statistics. The application will fetch aggregated analytics data from the MCP registry API (via GitHub Actions hourly aggregation) and display time-series charts with filtering capabilities for local vs remote servers. The dashboard supports multiple time granularities (hourly, daily, weekly, monthly), theme switching (dark/light), and includes an About page. Built as a Next.js application using shadcn UI components with a modern purple/blue/pink color scheme.

## Technical Context

**Language/Version**: TypeScript 5.x, Node.js 18+  
**Primary Dependencies**: Next.js 14+ (App Router), React 18+, shadcn/ui, Recharts (or similar charting library), Tailwind CSS  
**Storage**: Static JSON files generated by GitHub Actions (stored in repository or static hosting), localStorage for theme preference  
**Testing**: Jest, React Testing Library, Playwright (or similar E2E framework)  
**Target Platform**: Web browsers (Chrome, Firefox, Safari, Edge - latest 2 versions), static hosting (Vercel, Netlify, GitHub Pages)  
**Project Type**: web (Next.js single-page application)  
**Performance Goals**: Dashboard loads within 3 seconds (SC-001), chart updates within 1 second (SC-002), theme toggle within 500ms (SC-003)  
**Constraints**: Must be statically exportable (Next.js static export), responsive design (320px-1920px), API timeout handling (10s max), client-side data aggregation for large datasets  
**Scale/Scope**: Single-page dashboard with 2 routes (dashboard, about), 4 chart types (hourly/daily/weekly/monthly views), 3 filter states (all/local/remote), 2 theme modes

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### I. Static Website

**Status**: ✅ PASS (with configuration)

- Next.js supports static export via `next export` or `output: 'export'` in next.config.js
- All pages will be pre-rendered as static HTML/CSS/JS
- No server-side runtime dependencies required
- Can be served from any static hosting service

### II. Responsive Design

**Status**: ✅ PASS

- Mobile-first approach required (SC-004: 320px, 768px, 1920px breakpoints)
- shadcn/ui components are responsive by default
- Charts must adapt to different screen sizes

### III. Minimal Dependencies Unless Required

**Status**: ✅ PASS (justified - see Complexity Tracking below)

- **Next.js**: Required for React framework and static export capability. Provides built-in optimizations, code splitting, and App Router for routing. Alternative (vanilla JS) would require extensive manual tooling.
- **shadcn/ui**: Required for consistent, accessible UI components with theme support. Copy-paste model (not npm dependency) aligns with minimal dependencies. Alternative (custom components) would require implementing accessibility, theming, and responsive design manually.
- **Recharts**: Required for time-series chart visualization with date axes, multiple granularities, and responsive design (FR-001). Alternative (native Canvas/SVG) would require extensive custom implementation of chart logic, axis formatting, tooltips, and legends.
- **Tailwind CSS**: Required dependency of shadcn/ui for styling and theming system. Cannot use shadcn without Tailwind. Alternative CSS frameworks would require rewriting all shadcn components.

**Justification Summary**: All dependencies are essential for core functionality. Each dependency serves a specific requirement that cannot be met with fewer dependencies without significantly increasing implementation complexity or violating other constitution principles (accessibility, responsive design). Detailed justification provided in Complexity Tracking section below.

**Gate Evaluation**: ✅ PASS (with justification for dependencies)

## Project Structure

### Documentation (this feature)

```text
specs/001-mcp-analytics-dashboard/
├── plan.md              # This file (/speckit.plan command output)
├── research.md          # Phase 0 output (/speckit.plan command)
├── data-model.md        # Phase 1 output (/speckit.plan command)
├── quickstart.md        # Phase 1 output (/speckit.plan command)
├── contracts/           # Phase 1 output (/speckit.plan command)
└── tasks.md             # Phase 2 output (/speckit.tasks command - NOT created by /speckit.plan)
```

### Source Code (repository root)

```text
app/
├── page.tsx             # Main dashboard page
├── about/
│   └── page.tsx         # About page
├── layout.tsx           # Root layout with theme provider
└── globals.css          # Global styles and theme variables

components/
├── ui/                  # shadcn/ui components
│   ├── button.tsx
│   ├── select.tsx
│   ├── card.tsx
│   └── ...
├── charts/
│   ├── time-series-chart.tsx    # Main chart component
│   └── chart-wrapper.tsx        # Chart container with loading/error states
├── filters/
│   ├── server-type-filter.tsx   # Local/Remote/All filter
│   └── granularity-selector.tsx # Hourly/Daily/Weekly/Monthly selector
├── theme/
│   └── theme-toggle.tsx         # Dark/Light theme switcher
└── layout/
    ├── header.tsx               # Navigation header
    └── footer.tsx              # Footer (optional)

lib/
├── api/
│   └── analytics.ts            # API client for fetching analytics data
├── utils/
│   ├── data-aggregation.ts     # Client-side data aggregation by granularity
│   ├── server-classification.ts # Classify servers as local/remote
│   ├── date-formatting.ts      # Format dates for chart axes
│   └── theme.ts                # Theme management utilities
└── types/
    └── analytics.ts            # TypeScript types for analytics data

public/
└── data/                        # Static JSON files from GitHub Actions (optional)

.github/
└── workflows/
    └── aggregate-analytics.yml  # GitHub Actions workflow for data aggregation

tests/
├── __mocks__/
├── components/
│   ├── charts.test.tsx
│   ├── filters.test.tsx
│   └── theme.test.tsx
├── lib/
│   ├── api.test.ts
│   ├── data-aggregation.test.ts
│   └── server-classification.test.ts
└── e2e/
    └── dashboard.spec.ts        # Playwright E2E tests
```

**Structure Decision**: Next.js App Router structure (web application). The application uses the `app/` directory for routing, `components/` for reusable UI components organized by feature area, `lib/` for business logic and utilities, and `tests/` for unit and E2E tests. GitHub Actions workflow handles data aggregation and stores results as static JSON files.

## Complexity Tracking

> **Fill ONLY if Constitution Check has violations that must be justified**

| Violation | Why Needed | Simpler Alternative Rejected Because |
|-----------|------------|-------------------------------------|
| Next.js framework dependency | Required for React-based SPA with static export capability, App Router for routing, and built-in optimizations | Vanilla JS/HTML insufficient: would require manual bundling, routing, code splitting, and optimization. React without Next.js lacks static export and requires additional tooling. |
| shadcn/ui component library | Provides accessible, consistent UI components (buttons, selects, cards) with theme support | Building custom components from scratch would violate minimal dependencies principle more (would need to implement accessibility, theming, responsive design manually). |
| Charting library (Recharts) | Required for time-series chart visualization with date axes, multiple granularities, and responsive design (FR-001) | Native Canvas/SVG would require extensive custom implementation of chart logic, axis formatting, tooltips, legends, and responsive behavior. |
| Tailwind CSS | Required dependency of shadcn/ui for styling and theming system | Cannot use shadcn without Tailwind. Alternative CSS frameworks would require rewriting all shadcn components. |

## Post-Phase 1 Constitution Check

*Re-evaluation after Phase 1 design artifacts completed.*

### Post-Phase 1: I. Static Website

**Status**: ✅ PASS

- Design confirms static export configuration (`output: 'export'` in next.config.js)
- All data fetching is client-side (no API routes)
- GitHub Actions generates static JSON files
- No server-side runtime dependencies in final build

### Post-Phase 1: II. Responsive Design

**Status**: ✅ PASS

- Project structure includes responsive chart components
- shadcn/ui components provide responsive defaults
- Data model supports mobile-friendly time ranges
- Quickstart guide includes responsive design considerations

### Post-Phase 1: III. Minimal Dependencies Unless Required

**Status**: ✅ PASS (justified)

- All dependencies documented and justified in Complexity Tracking
- No additional dependencies introduced during design phase
- Design maintains minimal dependency approach

**Final Gate Evaluation**: ✅ PASS - All constitution requirements met with proper justification for dependencies.
